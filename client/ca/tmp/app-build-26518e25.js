function inputAndSelectDirective(){return{restrict:"E",require:"?ngModel",link:function(r,t,n,e){e&&t.one("blur",function(){r.$apply(function(){e.touched=!0})})}}}var MessageModule=angular.module("message",[]);MessageModule.factory("MessageApi",["$timeout","$rootScope",function(r){var t=2e3;return{status:null,message:null,show:!1,hasChanged:function(){var r=this._changed;return this._changed=!1,r},progress:function(r){this._clearPrevTimeout(),this.status="info",this.message=r||"操作中，请稍候",this.show=!0,this._changed=!0},success:function(r){this._clearPrevTimeout(),this._timeout(),this.status="success",this.message=r||"操作成功",this.show=!0,this._changed=!0},error:function(r){this.show=!1,this._changed=!0;var t="操作失败";alert(r||t)},finish:function(){var r=this;r.show=!1,this._changed=!0},_timeout:function(n){n=n||t;var e=this;this.timeoutPromise=r(function(){e.finish()},n)},_clearPrevTimeout:function(){this.timeoutPromise&&(r.cancel(this.timeoutPromise),this.timeoutPromise=null)}}}]),MessageModule.directive("message",["MessageApi","$timeout","$animate",function(r,t,n){return!window.angular.$$csp()&&window.angular.element(document).find("head").prepend('<style type="text/css">@charset "UTF-8";.gmessage-hide{display:none!important}.gmessage-hide-add-active,.gmessage-hide-remove{display:inline!important}.gmessage-hide-remove{-webkit-animation:expand .7s ease-out;animation:expand .7s ease-out}.gmessage-hide.gmessage-hide-add{-webkit-animation:fadeOut 1s;animation:fadeOut 1s}@-webkit-keyframes fadeOut{from{opacity:1}to{opacity:0}}@keyframes fadeOut{from{opacity:1}to{opacity:0}}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@-webkit-keyframes expand{50%{-webkit-transform:scale(1.08);transform:scale(1.08)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes expand{50%{-webkit-transform:scale(1.08);transform:scale(1.08)}to{-webkit-transform:scale(1);transform:scale(1)}}</style>'),{restrict:"AE",scope:{},replace:!0,link:function(t,e){t.api=r,t.$watch(function(){return r.hasChanged()},function(t,s){(t||t===s)&&(n.addClass(e,"gmessage-hide"),r.show&&n.removeClass(e,"gmessage-hide"))})},template:'<span class="label label-{{api.status}} gf-message">{{api.message}}</span>'}}]).directive("spinner",["$http",function(r){return{restrict:"EA",scope:{},replace:!0,template:'<span class="spinner"><img ng-show="spinnerVisible" src="/img/ajax-loader.gif" width="20" height="20" /></span>',link:function(t,n){n.children("img");t.$watch(function(){return r.pendingRequests.length>0},function(r){t.spinnerVisible=r?!0:!1})}}}]);var app=angular.module("gfForm",[]),formDirective=function(){return{priority:-400,restrict:"E",require:"form",link:function(r,t,n,e){t.on("submit",function(){r.$apply(function(){e.attempted=!0})})}}};app.directive("form",formDirective),app.directive("input",inputAndSelectDirective),app.directive("select",inputAndSelectDirective),app.directive("gfFormError",["FormError",function(r){return{restrict:"EA",require:"^form",scope:{},link:function(t,n,e,s){var i=e.gfFormError,o=s[i];if(!o)throw new Error("no such field name");t.$watchCollection(function(){return o.$error},function(n){t.message=r.getErrMsg(n)}),t.$watch(function(){return o.$invalid&&(o.$dirty&&o.touched||s.attempted)},function(r){t.visible=r?!0:!1})},template:'<span ng-show="visible">{{message}}</span>'}}]),app.factory("FormError",function(){function r(r,n,e){var s={};s[r]=n,void 0===e?t.push(s):t[e]=s}var t=[{required:"必填"},{equals:"两次输入不一致"},{minlength:"字符太少"},{maxlength:"字符太多"}];return{put:r,getErrMsg:function(r){for(var n,e,s=0;s<t.length&&(e=t[s],angular.forEach(e,function(t,e){r[e]&&(n=t)}),!n);s++);return n}}});var app=angular.module("myApp",["message","ui.bootstrap","ngSanitize","gfForm","ngRoute"]).config(["$routeProvider","$locationProvider",function(r){var t={templateUrl:"views/step1.html",controller:"Step1Ctrl",reloadOnSearch:!1};r.when("/step1",t).when("/step2",{templateUrl:"views/step2.html",controller:"Step2Ctrl"}).when("/step3",{templateUrl:"views/step3.html",controller:"Step3Ctrl"}).otherwise(t)}]).factory("CrapService",function(){var r;return{step:function(t){return t?(r=t,this):r},rechoose:function(){this.crapInfo.updating=!0}}}).controller("appCtrl",["$scope","$http","$modal","$log","$window","$timeout","CrapService","$animate",function(r,t,n,e,s,i,o){r.$watch(function(){return o.step()},function(t,n){t!==n&&(r.step=t||1)})}]).controller("Step1Ctrl",["$scope","$http","$location","$routeParams","$modal","CrapService","$timeout","$route",function(r,t,n,e,s,i){function o(){a(n.hash())}function a(r){r&&t.get("articles/"+r+"?ts="+ +new Date).success(function(r){var t=r.article;s.open({templateUrl:"views/article.modal.html",controller:"ModalInstanceCtrl",size:t.size||"lg",resolve:{article:function(){return t}}})})}i.step(1),o(),r.$on("$routeUpdate",function(){o()}),t.get("articles-meta").success(function(t){r.articlesMetaData=t.results}),r.open=function(r){n.path("/step1").hash(r)},r.start=function(){n.path("/step2")}}]).controller("ModalInstanceCtrl",["$scope","$modalInstance","article","$sce","$location",function(r,t,n,e,s){function i(r){r&&(o(),s.hash(""))}n&&n.content&&(n.content=e.trustAsHtml(n.content)),r.article=n,t.result.then(i,i);var o=r.$on("$locationChangeStart",function(){r.$close()})}]).controller("Step2Ctrl",["$rootScope","$scope","$http","$location","CrapService","$window","$timeout",function(r,t,n,e,s,i,o){s.step(2),t.ca=s.crapInfo||{},n.get("major").success(function(r){t.majors=r.majors}),t.submit=function(){this.caForm.$invalid||(t.submitting=!0,s.crapInfo=t.ca,n.post("/ca/credit-apply",t.ca).success(function(t){r.crapResult=t}).error(function(){r.crapResult={success:!1,reason:0}})["finally"](function(){e.path("/step3"),t.submitting=!1}))},t.back=function(){s.crapInfo=t.ca,e.path("/step1")},test=i.test=function(){o(function(){t.ca={cert:{name:"张志伟",idnumber:"654324199104120035",certnumber:"1449003012300160"},studNumber:"201299919911111"}})}}]).controller("Step3Ctrl",["$scope","$rootScope","$location","CrapService","$window",function(r,t,n,e,s){e.step(3),t.crapResult||(r.redirect=function(){n.path("/step1")}),angular.extend(r,t.crapResult),r.reapply=function(){n.path("/step2")},r.print=function(){s.print()},r.rechooseMajor=function(){e.rechoose(),n.path("/step2")}}]).directive("countdown",["$timeout",function(r){return{template:'<span ng-bind="count"></span>',scope:{countEnd:"&"},link:function(t,n,e){function s(){r(function(){t.count--,t.count?s():t.countEnd&&t.countEnd()},1e3)}if(t.count=+e.countdown,isNaN(t.count))throw new Error("countdown should be a number or string that can be transformed into a number");s()}}}]).directive("studNumber",["FormError",function(r){return r.put("studNumber","学号无效",1),{require:"ngModel",link:function(r,t,n,e){e.$parsers.push(function(r){var t=/^20\d{2}\d{3}[1-3]\d{7}$/;return e.$isEmpty(r)||t.test(r)?(e.$setValidity("studNumber",!0),r):void e.$setValidity("studNumber",!1)})}}}]);angular.module("myApp").run(["$templateCache",function(r){r.put("views/article.modal.html",'<div class="modal-readme">\r\n    <div class="modal-header" ng-if="article.title">\r\n        <h3 class="modal-title">{{article.title}}</h3>\r\n    </div>\r\n    <div class="modal-body" ng-bind-html="article.content">\r\n        \r\n    </div>\r\n    <div class="modal-footer">\r\n        <button class="btn btn-primary" ng-click="$close(\'some reason\')">确认</button>\r\n    </div>\r\n\r\n</div>\r\n'),r.put("views/failure.html",'<div class="appl-result">\r\n    <div class="alert alert-danger">对不起，审核未通过。未通过原因：</div>\r\n\r\n    <div ng-show="reason==\'0\'">请检查你的填写信息以及网络，若不是您的问题，请联系我们</div>\r\n\r\n    <div ng-show="reason==\'1\'">您未取得机械行业职业资格证书，请获取证书后再进行申报</div>\r\n\r\n    <div ng-show="reason==\'2\'">您申报的职业工种与所置换的远程教育专业不匹配，请仔细阅读步骤一中的学分置换范围及置换办法后再申报</div>\r\n    <div ng-show="reason==\'3\'">您的职业资格证书级别暂不符合置换范围，请取得三级（高级）及以上级别再申请。详见步骤一中的学分置换范围及置换办法</div>\r\n\r\n    \r\n</div>\r\n\r\n\r\n<button ng-click="restart()" class="btn btn-lg btn-primary">重新申请</button>'),r.put("views/report.html",'<div class="report">\r\n    <span>认证报告编号:</span> <span>{{report._id}}</span>\r\n    <table class="table table-bordered table-hover text-center">\r\n        <tr>\r\n            <td>身份证号</td>\r\n            <td>{{report.idnumber}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>姓名</td>\r\n            <td>{{report.name}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>性别</td>\r\n            <td>{{report.sex}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>学号</td>\r\n            <td>{{report.studNumber}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>证书号</td>\r\n            <td>{{report.certnumber}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>工种名称</td>\r\n            <td>{{report.worktype}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>申报置换远程教育专业</td>\r\n            <td>{{report.major}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>可置换专业层次</td>\r\n            <td>{{report.applEduLvl}}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>申请时间</td>\r\n            <td>{{report.appliedDate}}</td>\r\n        </tr>\r\n\r\n    </table>\r\n\r\n    <button class="btn btn-lg btn-primary ca-btn-print" ng-click="print()">打印报告</button>\r\n\r\n</div>'),r.put("views/step1.html",'<div class="intro">\r\n    <p>在递交《机械行业职业资格证书置换北京理工大学远程教育学分申请》前，申请者需认真阅读置换范围及办法，如实填写个人真实信息，并严格按照要求进行申请</p>\r\n    <p class="text-warning">若您已经申请成功，想查看申请结果，请重新输入申请信息</p>\r\n    <p>官方咨询电话：400-890-0161</p>\r\n</div>\r\n\r\n<div class="link-extra-info">\r\n    <a class="btn btn-default" ng-repeat="meta in articlesMetaData" ng-click="open(meta.slug)">{{meta.title}}</a>\r\n</div>\r\n<button ng-click="start()" class="btn btn-lg btn-primary ">开始申请</button>'),r.put("views/step2.html",'<div class="rechoose" ng-show="ca.updating">请重选你的专业</div>\r\n\r\n<!-- TODO: use some kind of custom directive, instead of these junk -->\r\n<form class="form-horizontal credit-apply" role="form" name="caForm" ng-submit="submit()" novalidate>\r\n    <div class="form-group">\r\n        <label for="name" class="col-sm-3 control-label">姓名</label>\r\n        <div class="col-sm-7">\r\n            <input type="text" class="form-control" id="name" ng-model="ca.cert.name" name="name" required>\r\n        </div>\r\n        <div class="text-danger col-sm-2 form-control-static" gf-form-error="name"></div>\r\n    </div>\r\n    <div class="form-group">\r\n        <label for="idnumber" class="col-sm-3 control-label">身份证号</label>\r\n        <div class="col-sm-7">\r\n            <input type="text" class="form-control" id="idnumber" ng-model="ca.cert.idnumber" name="idnumber" required>\r\n        </div>\r\n        <div class="text-danger col-sm-2 form-control-static" gf-form-error="idnumber"></div>\r\n    </div>\r\n\r\n    <div class="form-group">\r\n        <label for="certnumber" class="col-sm-3 control-label no-wrap">职业资格证书号</label>\r\n        <div class="col-sm-7">\r\n            <input type="text" class="form-control" id="certnumber" ng-model="ca.cert.certnumber" name="certnumber" required>\r\n        </div>\r\n        <div class="text-danger col-sm-2 form-control-static" gf-form-error="certnumber"></div>\r\n    </div>\r\n    \r\n    <div class="form-group">\r\n        <label for="studNumber" class="col-sm-3 control-label no-wrap">北理工入学学号</label>\r\n        <div class="col-sm-7">\r\n            <input type="text" class="form-control" id="studNumber" ng-model="ca.studNumber" name="studNumber" required stud-number>\r\n        </div>\r\n        <div class="text-danger col-sm-2 form-control-static" gf-form-error="studNumber"></div>\r\n    </div>\r\n\r\n    <div class="form-group">\r\n        <label for="major" class="col-sm-3 control-label no-wrap">选择申报专业</label>\r\n        <div class="col-sm-7">\r\n            <select id="major" class="form-control" ng-model="ca.majorId" ng-options="major._id as major.name for major in majors" required name="majorId">\r\n                <option value="">请选择专业</option>\r\n            </select>\r\n        </div>\r\n        <div class="text-danger col-sm-2 form-control-static" gf-form-error="majorId"></div>\r\n\r\n    </div>\r\n\r\n    <div class="form-group">\r\n        <div class="col-sm-offset-3 col-sm-7 btn-container">\r\n            <button type="submit" class="btn btn-primary" ng-disabled="submitting">提交</button>\r\n            <button type="button" class="btn btn-default" ng-click="back()">返回</button>\r\n        </div>\r\n    </div>\r\n\r\n    \r\n</form>'),r.put("views/step3.html",'<div ng-if="redirect">\r\n	<span>无法显示结果，请先进行申请</span>\r\n	<br/>\r\n	<span countdown="3" count-end="redirect()" class="countdown"></span>\r\n	<span>秒后为您跳转</span>\r\n</div>\r\n\r\n\r\n<div ng-if="!redirect && success">\r\n    <div class="appl-result">\r\n        <div class="success-info">\r\n            <div class="alert alert-success" ng-show="!hasApplied">申请成功</div>\r\n\r\n            <div ng-show="hasApplied" class="alert alert-warning">您已于{{appliedTime}}申请成功，请不要再次申请。您之前的申请记录为：\r\n            </div>\r\n        </div>\r\n\r\n        <p>\r\n            您已通过机械工业职业技能鉴定指导中心针对机械行业职业资格证书置换北理工远程教育专业学分资质认证审核，请打印认证书并携带至北京理工大学远程教育各学习中心报名。\r\n        </p>\r\n\r\n        <div ng-include="\'views/report.html\'"></div>\r\n\r\n        <p class="change-major">如果您申报错了专业，请\r\n            <button class="btn btn-sm btn-default" ng-click="rechooseMajor()">重新选择专业</button>\r\n        </p>\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n<div ng-if="!redirect&&!success">\r\n    <div class="appl-result">\r\n        <div class="alert alert-danger">对不起，审核未通过。未通过原因：</div>\r\n\r\n        <div ng-show="reason==\'0\'">请检查你的填写信息以及网络，若不是您的问题，请联系我们</div>\r\n\r\n        <div ng-show="reason==\'1\'">您未取得机械行业职业资格证书，请获取证书后再进行申报</div>\r\n\r\n        <div ng-show="reason==\'2\'">您申报的职业工种与所置换的远程教育专业不匹配，请仔细阅读步骤一中的学分置换范围及置换办法后再申报</div>\r\n        <div ng-show="reason==\'3\'">您的职业资格证书级别暂不符合置换范围，请取得三级（高级）及以上级别再申请。详见步骤一中的学分置换范围及置换办法</div>\r\n\r\n\r\n    </div>\r\n\r\n\r\n    <button ng-click="reapply()" class="btn btn-lg btn-primary">重新申请</button>\r\n</div>\r\n'),r.put("views/success.html",'<div class="appl-result">\r\n	<div class="success-info">\r\n	    <div class="alert alert-success" ng-show="!result.hasApplied">申请成功</div>\r\n\r\n		<div ng-show="hasApplied" class="alert alert-warning">您已于{{result.appliedTime}}申请成功，请不要再次申请。您之前的申请记录为：\r\n		</div>		\r\n	</div>\r\n\r\n    <p>\r\n        您已通过机械工业职业技能鉴定指导中心针对机械行业职业资格证书置换北理工远程教育专业学分资质认证审核，请打印认证书并携带至北京理工大学远程教育各学习中心报名。\r\n    </p>\r\n\r\n    <div ng-include="\'views/report.html\'"></div>\r\n\r\n    <p class="change-major">如果您申报错了专业，请\r\n		<button class="btn btn-sm btn-default" ng-click="restart(true)">重新选择专业</button>\r\n    </p>\r\n</div>\r\n')}]);
//# sourceMappingURL=../tmp/app-build-26518e25.js.map